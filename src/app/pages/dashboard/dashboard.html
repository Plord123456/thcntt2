<!-- Thanh Header -->
<div class="header-bar">
  <div class="brand">HỆ THỐNG QUẢN LÝ NHÂN SỰ</div>
  <div class="user-actions">
    <span>Xin chào, Admin!</span>
    <!-- SỬA LỖI: Dùng (click) để gọi hàm điều hướng -->
    <button class="btn btn-info" (click)="goToEmployeeManagement()">Quản lý Nhân viên</button>
    <button class="btn btn-danger" (click)="logout()">Đăng xuất</button>
  </div>
</div>

<!-- Nội dung chính -->
<div class="main-container">
  <h1 class="page-title">Bảng điều khiển</h1>

  <!-- Các thẻ thống kê nhanh -->
  <div class="stats-grid">
    <div class="stat-card employees">
      <h2>Tổng Nhân Viên</h2>
      <p>{{ stats.totalEmployees }}</p>
    </div>
    <div class="stat-card present">
      <h2>Chấm Công Hôm Nay</h2>
      <p>{{ stats.attendanceToday }}</p>
    </div>
    <div class="stat-card late">
      <h2>Đi Trễ Hôm Nay</h2>
      <p>{{ stats.lateToday }}</p>
    </div>
  </div>

  <!-- Bảng lịch sử chấm công -->
  <div class="card">
    <div class="card-header">
      <h3>Lịch sử Chấm công</h3>
      <!-- THÊM MỚI: Bộ lọc theo ngày -->
      <div class="filter-controls">
        <label for="attendance-date">Xem dữ liệu ngày:</label>
        <input
          type="date"
          id="attendance-date"
          class="date-input"
          [(ngModel)]="selectedDate"
          (change)="onDateChange()">
      </div>
    </div>
    <div class="card-body">
      <div class="table-wrapper">
        <table class="custom-table">
          <thead>
          <tr>
            <th>Họ và Tên</th>
            <th>RFID</th>
            <th>Ngày</th>
            <th>Giờ Vào</th>
            <th>Giờ Ra</th>
            <th>Trạng thái</th>
          </tr>
          </thead>
          <tbody>
          <!-- Vòng lặp hiển thị dữ liệu -->
          <tr *ngFor="let record of chamCongData">
            <td>{{ record.HoVaTen || 'Chưa cập nhật' }}</td>
            <td>{{ record.RFID }}</td>
            <td>{{ record.Ngay | date: 'dd/MM/yyyy' }}</td>
            <td>{{ record.ThoiGianVao }}</td>
            <td>{{ record.ThoiGianRa || 'N/A' }}</td>
            <td>
                                <span class="badge" [ngClass]="{'badge-success': record.Status === 'DUNG GIO', 'badge-danger': record.Status === 'DI TRE'}">
                                    {{ record.Status }}
                                </span>
            </td>
          </tr>
          <!-- Hiển thị khi đang tải dữ liệu -->
          <tr *ngIf="isLoading">
            <td colspan="6" class="loading-cell">Đang tải dữ liệu...</td>
          </tr>
          <!-- Hiển thị khi không có dữ liệu -->
          <tr *ngIf="!isLoading && chamCongData.length === 0">
            <td colspan="6" class="no-data-cell">Không có dữ liệu chấm công cho ngày đã chọn.</td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
